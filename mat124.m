y0=[133077,3438,1213,1219,2843];
tspan=0:1:40;
[t,y]=ode45(@(t,y) ode_fun(t,y),tspan,y0);
[t,s]=ode45(@(t,s) ode_fun2(t,s),tspan,y0);
[t,w]=ode45(@(t,w) ode_fun3(t,w),tspan,y0);
[t,b]=ode45(@(t,b) ode_fun4(t,b),tspan,y0);
[t,v]=ode45(@(t,v) ode_fun5(t,v),tspan,y0);
figure(1); hold on;
K1=0.56*0.8*1.1;
K2=0.56*0.8*1.1*0.5;
K3=0.56*0.8*1.1*0.5*0.4;
K4=0.56*0.8*1.1*0.5*0.04;
K=(y(:,2).*K1+y(:,3).*K2+y(:,4).*K3+y(:,5).*K4)./(y(:,1)+(y(:,2)+y(:,3)+y(:,4)+y(:,5)));
KX=K.*y(:,1);
K12=0.56*0.8*1.2;
K22=0.56*0.8*1.2*0.5;
K32=0.56*0.8*1.2*0.5*0.4;
K42=0.56*0.8*1.2*0.5*0.04;
K2=(s(:,2).*K12+s(:,3).*K22+s(:,4).*K32+s(:,5).*K42)./(s(:,1)+(s(:,2)+s(:,3)+s(:,4)+s(:,5)));
KX2=K2.*s(:,1);
K13=0.56*0.8*1.3;
K23=0.56*0.8*1.3*0.5;
K33=0.56*0.8*1.3*0.5*0.4;
K43=0.56*0.8*1.3*0.5*0.04;
K3=(w(:,2).*K13+w(:,3).*K23+w(:,4).*K33+w(:,5).*K43)./(w(:,1)+(w(:,2)+w(:,3)+w(:,4)+w(:,5)));
KX3=K3.*w(:,1);
K14=0.56*0.8*1;
K24=0.56*0.8*1*0.5;
K34=0.56*0.8*1*0.5*0.4;
K44=0.56*0.8*1*0.5*0.04;
K4=(b(:,2).*K14+b(:,3).*K24+b(:,4).*K34+b(:,5).*K44)./(b(:,1)+(b(:,2)+b(:,3)+b(:,4)+b(:,5)));
KX4=K4.*b(:,1);
K15=1*0.8*1;
K25=1*0.8*1*0.5;
K35=1*0.8*1*0.5*0.4;
K45=1*0.8*1*0.5*0.04;
K5=(v(:,2).*K15+v(:,3).*K25+v(:,4).*K35+v(:,5).*K45)./(v(:,1)+(v(:,2)+v(:,3)+v(:,4)+v(:,5)));
KX5=K5.*v(:,1);
plot(tspan,KX5,'-s','MarkerIndices',1:5:length(KX5));
hold on;
plot(tspan,KX4,'-o','MarkerIndices',1:5:length(KX4));
hold on;
plot(tspan,KX,'-*','MarkerIndices',1:5:length(KX));
hold on;
plot(tspan,KX2,'-+','MarkerIndices',1:5:length(KX2));
hold on;
plot(tspan,KX3,'-d','MarkerIndices',1:5:length(KX3));
xlabel('year'); ylabel('Number(KX)');
legend('Current Situation', 'Scenario 3', 'Scenario 4-1', 'Scenario 4-2', 'Scenario 4-3');
hold off;

Y=y(:,5)+y(:,2)+y(:,3)+y(:,4);
Y2=s(:,5)+s(:,2)+s(:,3)+s(:,4);
Y3=w(:,5)+w(:,2)+w(:,3)+w(:,4);
Y4=b(:,5)+b(:,2)+b(:,3)+b(:,4);
Y5=v(:,5)+v(:,2)+v(:,3)+v(:,4);
figure(2); hold on;
plot(tspan,Y5,'-s','MarkerIndices',1:5:length(Y5));
hold on;
plot(tspan,Y4,'-o','MarkerIndices',1:5:length(Y4));
hold on;
plot(tspan,Y,'-*','MarkerIndices',1:5:length(Y));
hold on;
plot(tspan,Y2,'-+','MarkerIndices',1:5:length(Y2));
hold on;
plot(tspan,Y3,'-d','MarkerIndices',1:5:length(Y3));
xlabel('year'); ylabel('Number(Y1-4)');
legend('Current Situation','Scenario 3','Scenario 4-1', 'Scenario 4-2', 'Scenario 4-3' );
hold off;

figure(3); hold on;
plot(tspan,y);
xlabel('year'); ylabel('Population');
legend('X','Y1','Y2', 'Y3', 'Y4' )