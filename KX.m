function [KX,KX2,KX3,KX4,KX5] = KX(y,s,w,b,v)
% This function is to multiply X population with K, while K is changing
% with Y populations under different Scenarios

% 4-1
K1=0.56*0.8*1.1;
K2=0.56*0.8*1.1*0.5;
K3=0.56*0.8*1.1*0.5*0.4;
K4=0.56*0.8*1.1*0.5*0.04;
K=(y(:,2).*K1+y(:,3).*K2+y(:,4).*K3+y(:,5).*K4)./(y(:,1)+(y(:,2)+y(:,3)+y(:,4)+y(:,5))); % y = [X, Y1, Y2,Y3,Y4]
KX=K.*y(:,1);

% 4-2
K12=0.56*0.8*1.2;
K22=0.56*0.8*1.2*0.5;
K32=0.56*0.8*1.2*0.5*0.4;
K42=0.56*0.8*1.2*0.5*0.04;
K2=(s(:,2).*K12+s(:,3).*K22+s(:,4).*K32+s(:,5).*K42)./(s(:,1)+(s(:,2)+s(:,3)+s(:,4)+s(:,5)));
KX2=K2.*s(:,1);

% 4-3
K13=0.56*0.8*1.3;
K23=0.56*0.8*1.3*0.5;
K33=0.56*0.8*1.3*0.5*0.4;
K43=0.56*0.8*1.3*0.5*0.04;
K3=(w(:,2).*K13+w(:,3).*K23+w(:,4).*K33+w(:,5).*K43)./(w(:,1)+(w(:,2)+w(:,3)+w(:,4)+w(:,5)));
KX3=K3.*w(:,1);

% 3
K14=0.56*0.8*1;
K24=0.56*0.8*1*0.5;
K34=0.56*0.8*1*0.5*0.4;
K44=0.56*0.8*1*0.5*0.04;
K4=(b(:,2).*K14+b(:,3).*K24+b(:,4).*K34+b(:,5).*K44)./(b(:,1)+(b(:,2)+b(:,3)+b(:,4)+b(:,5)));
KX4=K4.*b(:,1);

% current
K15=1*0.8*1;
K25=1*0.8*1*0.5;
K35=1*0.8*1*0.5*0.4;
K45=1*0.8*1*0.5*0.04;
K5=(v(:,2).*K15+v(:,3).*K25+v(:,4).*K35+v(:,5).*K45)./(v(:,1)+(v(:,2)+v(:,3)+v(:,4)+v(:,5)));
KX5=K5.*v(:,1);
end